// Suppose that the educator can assign a personal score, the battle is in the consolidation phase and the educator is also the creator of the battle and submits a correct score
frame Submit a personal evaluation

fontawesome6solid f390 WebApp
participant API Gateway
participant Tournament Manager
database Tournament DB
participant Battle Manager
database Battle DB
participantspacing 5

activate WebApp
WebApp->API Gateway: 1: getTournament(id)
activate API Gateway
API Gateway->Tournament Manager: 2: getTournament(id)
activate Tournament Manager

Tournament Manager->Tournament DB: 3: executeQuery(Tournament id)
activate Tournament DB

alt tournament_id_valid == true
Tournament DB-->Tournament Manager: 4: success
Tournament Manager-->API Gateway: 5: result
API Gateway-->WebApp: 6: result
WebApp->API Gateway: 7: getBattle(id)
API Gateway->Battle Manager: 8: getBattle(id)
activate Battle Manager

Battle Manager->Battle DB: 9: executeQuery(Battle id)

activate Battle DB
alt battle_id_valid == true
Battle DB-->Battle Manager: 10: success
Battle Manager-->API Gateway: 11: result
API Gateway-->WebApp: 12: result
deactivate Battle Manager

WebApp->API Gateway: 13: getTeams(Battle id)
API Gateway->Battle Manager: 14: getTeams(Battle id)
activate Battle Manager
Battle Manager->Battle DB: 15: executeQuery(Battle id)
Battle DB-->Battle Manager: 16: success
Battle Manager-->API Gateway: 17: result
API Gateway-->WebApp: 18: result

WebApp->API Gateway: 19: assignPersonalScore(Team id, score)
API Gateway->Battle Manager: 20: assignPersonalScore(Team id, score)
// Query to update the score of students
Battle Manager->Battle DB: 21: executeQuery(Team id, score)
Battle DB-->Battle Manager: 22: success
else
Battle DB->Battle Manager: invalid_id
deactivate Battle DB
end

Battle Manager-->API Gateway: 23: result
deactivate Battle Manager
API Gateway-->WebApp: 24: result

else 
Tournament DB-->Tournament Manager: invalid_id
deactivate Tournament DB
Tournament Manager-->API Gateway: result
deactivate Tournament Manager
API Gateway-->WebApp: result
end

